Code for analysis of the temporal dynamics of a periodic signal. A periodic signal can either be relatively continuous or bursty, and this code quantifies the number of bursts and the burst duration within the frequency range of the periodic signal. For analysis of alpha-like oscillations in mice, the frequency range of interest is within 2-10 Hz. 

This code requires MATLAB and the signal processing toolbox in MATLAB. Depending on user inputs, it may also require the Chronux toolbox. It was developed on version R2018b, and subsequently revised in R2022b to include code for calculating effect size that requires a version of MATLAB from 2022 or later. 

To use this code, you can simply execute run_burst_analysis.m. To execute, you need to have all the dependencies in the path, and the data in the current folder. The run time with each set of example data is about 18 seconds, but varies based on the time it takes the user to respond to the prompted questions. 

In lines 38-60 of the code, the user can select which data files to analyze. The code will automatically run with the example data files included in GitHub (one example freely-moving dataset from each genotype, one example head-fixed dataset from each genotype). If the user would like to analyze a different dataset, they will need to add that data file to the current folder from FigShare, and then comment out the current data file and uncomment the data file of interest. Make sure to match the data files between genotypes!

There is one user-defined parameter listed at the top of run_burst_analysis.m. It does not need to be adjusted for the code to execute properly, but can be modified if the user so desires. It allows the user to adjust the threshold for defining a burst (default 0.9, or 90th percentile of the amplitude values, as used in the manuscript). 

When the user runs the code, they will first be prompted to answer if they are analyzing freely-moving data (EEG/LFP) or head-fixed data (L4 LFP). This affects the data file analyzed, as well as the band edges used for band-passing, as the EEG data was noisier. The user will then be asked if they would like to zero-pad the data or implement edge-trimming. These options are in case the data has large edge effects. The data included in our manuscript does not have large edege effects, so using these options are not necessary to reproduce our results (and they do not significantly change the results); however, we include them as an option in case future users would like to analyze other data that does have large edge effects. Finally, the user will be asked if they would like to see a time-frequency analysis of the time-series during the burst analysis (i.e., to confirm no large edge effects).  

Dependencies: This code calls on the BURST_ANALYSIS.m or BURST_ANALYSIS_W_SPECGM.m (depending on the answer to the last user-prompted question regarding the time-frequency analysis) to quantify burst count and duration based on this threshold value from the Hilbert-transformed, bandpassed amplitude signal. Code for band-passing the signal (eegfilt.m) was developed by Scott Makeig (copyright 1997) and is included in the dependencies folder for convenience. If the user chooses to see the time-frequency analysis, then the code will also call on a function from the Chronux Toolbox for signal processing. Please download Chronux version 2.12 here: https://chronux.org/ 
