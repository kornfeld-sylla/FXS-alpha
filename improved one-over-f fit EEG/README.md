Code for analysis of the 1/f fit of EEG signals from mouse and human. The code uses the same math as SpecParam, namely Lorentzian Functions, but SpecParam has difficulty fitting the signal well at the lowest frequencies and between 10-20 Hz and often estimates underlying 1/f power in these regions. This code tailors the fit specifically to these troublesome regions for an improved 1/f fit.

This code requires MATLAB, and was developed in version R2018b. This code also calls on functions from the Chronux Toolbox for signal processing. Please download Chronux version 2.12 here: https://chronux.org/

To use this code, simply execute run_improved_EEG_fit.m. To execute, you need to have all the dependencies in the path, including the Chronux code, and the data in the current folder. 

There are several user-defined parameters at the top of rum_improved_EEG_fit.m. The code will execute properly with the parameters as they are, but they are modifiable. With the first parameter, the user indicates the length of the time series segments they would like to analyze in the frequency domain (in this paper, we used 5s for mice, and 2s for humans). This parameter must be 5s for the example data in this Github. With the second parameter, the user can indicate the frequency range over which you want to fit the 1/f, the default is [2 55] which is what we used for mice (for humans, we used [3 55]). However, it is possible to fit out to higher frequencies, even if there is a 60 Hz notch filter. The highest frequency you can fit out to is the largest frequency unaffected by any low pass filtering. The next parameter allows you to set the number of periodic peaks to analyze. Mice have one periodic peak, humans have 2, so the default is 1 here. The following parameter allows you to indicate the frequency resolution you would like to have for the multi-taper power spectrum, which must be an even number greater than or equal to 2 (recommended, default). Finally, the last parameter controls the confidence interval you want for bootstrapping. Accepted values are 95 and 99. We recommend 99 fo mice (default) and 95 for human data.

Dependencies: This code calls on improved_EEG_fit.m to calculate the power spectra from the given time-series. This code calls upon another script, st_fit_EEG.m, which finds the aperiodic fit for the average power spectrum per subject and also finds the center frequencies and powers of the periodic peaks. It will find these peaks through automated methods, but may ask you to confirm an unusal peak value by entering yes (1) or no (0). Instructions for this process will pop up in the command window as you run the code.

Additional dependencies: For plotting power spectra and running bootstrap statistics, the code also calls on plot_spectrum_two_group.m and fg_bootstrap_two_groups.m.
